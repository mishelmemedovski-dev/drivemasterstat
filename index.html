<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DrivemasterStat</title>
    
    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0f172a">
    <meta name="description" content="DrivemasterStat - Fahrpr√ºfungs Statistiken App">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Web App Manifest -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='192' height='192' viewBox='0 0 192 192'><rect width='192' height='192' fill='%230f172a'/><rect width='144' height='64' x='24' y='80' rx='16' stroke='white' stroke-width='16' fill='none'/><path d='M40 144v16' stroke='white' stroke-width='16' stroke-linecap='round'/><path d='M152 144v16' stroke='white' stroke-width='16' stroke-linecap='round'/></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='180' height='180' viewBox='0 0 180 180'><rect width='180' height='180' fill='%230f172a'/><rect width='135' height='60' x='22.5' y='75' rx='15' stroke='white' stroke-width='15' fill='none'/><path d='M37.5 135v15' stroke='white' stroke-width='15' stroke-linecap='round'/><path d='M142.5 135v15' stroke='white' stroke-width='15' stroke-linecap='round'/></svg>">

    <!-- React & Babel -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { font-size: 16px; }
        body { 
            font-family: system-ui, -apple-system, sans-serif;
            background: #f8fafc;
            color: #1e293b;
            min-height: 100vh;
            padding-bottom: 100px;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* LAYOUT */
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .items-start { align-items: flex-start; }
        .items-end { align-items: flex-end; }
        .justify-center { justify-content: center; }
        .justify-between { justify-content: space-between; }
        .justify-around { justify-content: space-around; }
        .gap-1 { gap: 0.25rem; }
        .gap-2 { gap: 0.5rem; }
        .gap-3 { gap: 0.75rem; }
        .gap-4 { gap: 1rem; }
        .w-full { width: 100%; }
        .w-6 { width: 1.5rem; }
        .w-14 { width: 3.5rem; }
        .w-16 { width: 4rem; }
        .h-3 { height: 0.75rem; }
        .h-6 { height: 1.5rem; }
        .h-14 { height: 3.5rem; }
        .p-2 { padding: 0.5rem; }
        .p-3 { padding: 0.75rem; }
        .p-4 { padding: 1rem; }
        .p-5 { padding: 1.25rem; }
        .p-6 { padding: 1.5rem; }
        .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
        .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
        .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
        .pt-6 { padding-top: 1.5rem; }
        .pb-12 { padding-bottom: 3rem; }
        .mt-1 { margin-top: 0.25rem; }
        .mt-2 { margin-top: 0.5rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-3 { margin-bottom: 0.75rem; }
        .mb-4 { margin-bottom: 1rem; }
        .-mt-8 { margin-top: -2rem; }
        
        /* COLORS */
        .text-white { color: white; }
        .text-blue-100 { color: #dbeafe; }
        .text-blue-600 { color: #2563eb; }
        .text-green-600 { color: #16a34a; }
        .text-green-700 { color: #15803d; }
        .text-red-500 { color: #ef4444; }
        .text-red-600 { color: #dc2626; }
        .text-red-700 { color: #b91c1c; }
        .text-slate-300 { color: #cbd5e1; }
        .text-slate-400 { color: #94a3b8; }
        .text-slate-500 { color: #64748b; }
        .text-slate-600 { color: #475569; }
        .text-slate-800 { color: #1e293b; }
        .text-slate-900 { color: #0f172a; }
        .bg-white { background: white; }
        .bg-blue-50 { background: #eff6ff; }
        .bg-blue-100 { background: #dbeafe; }
        .bg-blue-900 { background: #111e3a; }
        .bg-green-50 { background: #f0fdf4; }
        .bg-green-100 { background: #dcfce7; }
        .bg-red-50 { background: #fef2f2; }
        .bg-red-100 { background: #fee2e2; }
        .bg-slate-50 { background: #f8fafc; }
        .bg-slate-100 { background: #f1f5f9; }
        .bg-slate-200 { background: #e2e8f0; }
        .bg-slate-900 { background: #0f172a; }
        
        /* TEXT */
        .text-xs { font-size: 0.75rem; }
        .text-sm { font-size: 0.875rem; }
        .text-lg { font-size: 1.125rem; }
        .text-xl { font-size: 1.25rem; }
        .text-2xl { font-size: 1.5rem; }
        .text-3xl { font-size: 1.875rem; }
        .font-medium { font-weight: 500; }
        .font-bold { font-weight: 700; }
        .font-black { font-weight: 900; }
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        
        /* BORDERS */
        .border { border: 1px solid #e2e8f0; }
        .border-b { border-bottom: 1px solid #e2e8f0; }
        .border-t { border-top: 1px solid #e2e8f0; }
        .border-2 { border-width: 2px; }
        .border-4 { border-width: 4px; }
        .border-white { border-color: white; }
        .border-green-500 { border-color: #22c55e; }
        .border-red-500 { border-color: #ef4444; }
        .border-slate-100 { border-color: #f1f5f9; }
        .border-slate-200 { border-color: #e2e8f0; }
        .border-red-200 { border-color: #fecaca; }
        .border-blue-200 { border-color: #bfdbfe; }
        .rounded { border-radius: 0.25rem; }
        .rounded-lg { border-radius: 0.5rem; }
        .rounded-xl { border-radius: 0.75rem; }
        .rounded-2xl { border-radius: 1rem; }
        .rounded-full { border-radius: 9999px; }
        .rounded-b-3xl { border-bottom-left-radius: 1.5rem; border-bottom-right-radius: 1.5rem; }
        
        /* SHADOW */
        .shadow-sm { box-shadow: 0 1px 2px 0 rgba(0,0,0,0.05); }
        .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); }
        .shadow-xl { box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); }
        
        /* FORMS */
        input, textarea, select {
            width: 100%;
            padding: 0.75rem;
            background: #f8fafc;
            border: 1px solid transparent;
            border-radius: 0.75rem;
            font: inherit;
            font-size: 1rem;
            font-weight: 500;
            outline: none;
            transition: all 0.2s;
        }
        input:focus, textarea:focus {
            background: white;
            border-color: #2563eb;
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.1);
        }
        input[type="file"] { display: none; }
        
        /* BUTTONS */
        button {
            font-family: inherit;
            cursor: pointer;
            border: none;
            background: none;
            transition: all 0.2s;
        }
        button:active { transform: scale(0.95); }
        
        /* NAVIGATION */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-top: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 0.5rem 0;
            padding-bottom: calc(0.5rem + env(safe-area-inset-bottom));
            z-index: 9999;
            box-shadow: 0 -4px 6px -1px rgba(0,0,0,0.05);
        }
        .nav-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 0.5rem;
            width: 4rem;
            color: #94a3b8;
            transition: color 0.2s;
        }
        .nav-btn.active { color: #2563eb; }
        .nav-btn svg { width: 24px; height: 24px; stroke-width: 2; }
        .nav-btn.add-btn {
            width: 3.5rem;
            height: 3.5rem;
            background: #0f172a;
            color: white;
            border-radius: 9999px;
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
            margin-top: -2rem;
        }
        
        /* HEADER */
        header {
            background: #0f172a;
            color: white;
            padding: 1.5rem;
            padding-bottom: 3rem;
            border-radius: 0 0 1.5rem 1.5rem;
            box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1);
            margin-bottom: 1rem;
        }
        header h1 { font-size: 1.5rem; font-weight: 700; }
        header p { color: #94a3b8; font-size: 0.875rem; margin-top: 0.25rem; }
        
        /* CARDS */
        .card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 1rem;
            padding: 1.25rem;
            box-shadow: 0 1px 2px 0 rgba(0,0,0,0.05);
        }
        
        /* PROGRESS BAR */
        .progress-bar {
            width: 100%;
            height: 0.75rem;
            background: #f1f5f9;
            border-radius: 9999px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: #0f172a;
            border-radius: 9999px;
            transition: width 0.3s ease;
        }
        
        /* MISC */
        .inline-block { display: inline-block; }
        .overflow-hidden { overflow: hidden; }
        .cursor-pointer { cursor: pointer; }
        .relative { position: relative; }
        .absolute { position: absolute; }
        .last\:border-0:last-child { border: none !important; }
        .space-y > * + * { margin-top: 1.5rem; }
        .space-y { display: flex; flex-direction: column; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        
        function DrivemasterStat() {
            // Service Worker registrieren - KORREKT!
            useEffect(() => {
                if ('serviceWorker' in navigator) {
                    navigator.serviceWorker.register('./sw.js', { scope: './' })
                        .then(reg => console.log('‚úÖ Service Worker registered:', reg))
                        .catch(err => console.error('‚ùå SW error:', err));
                }
            }, []);

            const [exams, setExams] = useState(() => {
                try {
                    const saved = localStorage.getItem('drivemaster_exams');
                    return saved ? JSON.parse(saved) : [];
                } catch (e) {
                    console.error('Error loading data:', e);
                    return [];
                }
            });
            const [activeTab, setActiveTab] = useState('dashboard');

            useEffect(() => {
                localStorage.setItem('drivemaster_exams', JSON.stringify(exams));
            }, [exams]);

            useEffect(() => {
                if (window.lucide) {
                    window.lucide.createIcons();
                }
            }, [activeTab, exams]);

            // DASHBOARD
            const DashboardView = () => {
                const currentYear = new Date().getFullYear();
                const stats = useMemo(() => {
                    const years = Array.from(new Set(exams.map(e => new Date(e.date).getFullYear())))
                        .sort((a, b) => b - a);
                    if (years.length === 0) years.push(currentYear);
                    
                    return years.map(year => {
                        const yearExams = exams.filter(e => new Date(e.date).getFullYear() === year);
                        const total = yearExams.length;
                        const passed = yearExams.filter(e => e.passed).length;
                        const failed = total - passed;
                        const rate = total > 0 ? Math.round((passed / total) * 100) : 0;
                        return { year, total, passed, failed, rate };
                    });
                }, [exams, currentYear]);

                const expertStats = useMemo(() => {
                    const experts = {};
                    exams.forEach(e => {
                        if (!experts[e.expert]) experts[e.expert] = { total: 0, failed: 0 };
                        experts[e.expert].total += 1;
                        if (!e.passed) experts[e.expert].failed += 1;
                    });
                    return Object.entries(experts)
                        .map(([name, stat]) => ({
                            name,
                            failRate: Math.round((stat.failed / stat.total) * 100),
                            total: stat.total
                        }))
                        .filter(e => e.total >= 3)
                        .sort((a, b) => b.failRate - a.failRate)
                        .slice(0, 5);
                }, [exams]);

                return (
                    <div className="space-y">
                        <header>
                            <h1>DrivemasterStat</h1>
                            <p>{exams.length} Pr√ºfungen erfasst</p>
                        </header>

                        <div className="px-4 space-y">
                            {stats.map(stat => (
                                <div key={stat.year} className="card">
                                    <div className="flex justify-between items-end mb-3">
                                        <span className="text-xl font-bold text-slate-800">{stat.year}</span>
                                        <span className={`text-3xl font-black ${stat.rate >= 70 ? 'text-green-600' : 'text-red-500'}`}>{stat.rate}%</span>
                                    </div>
                                    <div className="progress-bar mb-4">
                                        <div className="progress-fill" style={{width: `${stat.rate}%`}}></div>
                                    </div>
                                    <div className="flex gap-4 text-sm font-bold text-slate-600">
                                        <span className="flex items-center gap-1">
                                            <svg className="text-green-600" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="20 6 9 17 4 12"></polyline></svg>
                                            {stat.passed}
                                        </span>
                                        <span className="flex items-center gap-1">
                                            <svg className="text-red-600" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                                            {stat.failed}
                                        </span>
                                    </div>
                                </div>
                            ))}

                            {expertStats.length > 0 && (
                                <div className="card" style={{marginTop: '2rem'}}>
                                    <div className="bg-slate-50 p-4 -m-5 mb-4 rounded-t-2xl border-b font-bold text-slate-700">Strenge Experten (Top 5)</div>
                                    {expertStats.map((exp, idx) => (
                                        <div key={exp.name} className="flex justify-between items-center p-4 border-b last:border-0">
                                            <div className="flex items-center gap-3">
                                                <span className="w-6 h-6 bg-slate-200 rounded-full flex items-center justify-center text-xs font-bold">{idx + 1}</span>
                                                <span className="font-medium text-slate-800">{exp.name}</span>
                                            </div>
                                            <div className="text-right">
                                                <div className="text-red-600 font-bold text-sm">{exp.failRate}% Fail</div>
                                                <div className="text-xs text-slate-400">{exp.total} Pr√ºfungen</div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    </div>
                );
            };

            // ADD FORM
            const AddExamView = () => {
                const [form, setForm] = useState({
                    firstName: '',
                    lastName: '',
                    expert: '',
                    date: new Date().toISOString().split('T')[0],
                    passed: true,
                    notes: '',
                    error: ''
                });

                const handleSubmit = (e) => {
                    e.preventDefault();
                    if (!form.firstName.trim() || !form.lastName.trim() || !form.expert.trim()) {
                        alert('Bitte f√ºllen Sie alle Felder aus');
                        return;
                    }
                    
                    const newExam = {
                        id: crypto.randomUUID(),
                        firstName: form.firstName,
                        lastName: form.lastName,
                        expert: form.expert,
                        date: form.date,
                        passed: form.passed,
                        notes: form.notes,
                        error: form.error,
                        timestamp: Date.now()
                    };
                    
                    setExams([newExam, ...exams]);
                    setForm({
                        firstName: '',
                        lastName: '',
                        expert: '',
                        date: new Date().toISOString().split('T')[0],
                        passed: true,
                        notes: '',
                        error: ''
                    });
                    setActiveTab('list');
                    alert('‚úÖ Pr√ºfung gespeichert!');
                };

                return (
                    <div className="px-4 pt-6 space-y">
                        <h2 className="text-2xl font-bold text-slate-900 px-2">Neue Pr√ºfung</h2>
                        <form onSubmit={handleSubmit} className="space-y">
                            <div className="card space-y">
                                <div>
                                    <label className="text-xs font-bold text-slate-400">DATUM</label>
                                    <input type="date" required value={form.date} onChange={e => setForm({...form, date: e.target.value})} />
                                </div>
                                <div>
                                    <label className="text-xs font-bold text-slate-400">EXPERTE</label>
                                    <input type="text" placeholder="Name" required value={form.expert} onChange={e => setForm({...form, expert: e.target.value})} />
                                </div>
                            </div>
                            
                            <div className="card space-y">
                                <div>
                                    <label className="text-xs font-bold text-slate-400">VORNAME</label>
                                    <input type="text" placeholder="Max" required value={form.firstName} onChange={e => setForm({...form, firstName: e.target.value})} />
                                </div>
                                <div>
                                    <label className="text-xs font-bold text-slate-400">NACHNAME</label>
                                    <input type="text" placeholder="Muster" required value={form.lastName} onChange={e => setForm({...form, lastName: e.target.value})} />
                                </div>
                            </div>

                            <div className="flex gap-3 px-4">
                                <button type="button" onClick={() => setForm({...form, passed: true})} className={`flex-1 py-4 rounded-xl font-bold flex flex-col items-center gap-1 border-2 transition-all ${form.passed ? 'border-green-500 bg-green-50 text-green-700' : 'border-slate-100 bg-white text-slate-400'}`}>
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                                    <span className="text-xs">BESTANDEN</span>
                                </button>
                                <button type="button" onClick={() => setForm({...form, passed: false})} className={`flex-1 py-4 rounded-xl font-bold flex flex-col items-center gap-1 border-2 transition-all ${!form.passed ? 'border-red-500 bg-red-50 text-red-700' : 'border-slate-100 bg-white text-slate-400'}`}>
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>
                                    <span className="text-xs">FAIL</span>
                                </button>
                            </div>

                            {!form.passed && (
                                <div className="card bg-red-50 border-red-100 space-y">
                                    <label className="text-xs font-bold text-red-500">GRUND F√úR FEHLER</label>
                                    <textarea rows="3" value={form.error} onChange={e => setForm({...form, error: e.target.value})} placeholder="Was lief schief?" style={{background: 'white', borderColor: '#fecaca'}}></textarea>
                                </div>
                            )}
                            
                            <div className="card space-y">
                                <label className="text-xs font-bold text-slate-400">NOTIZEN</label>
                                <textarea rows="2" value={form.notes} onChange={e => setForm({...form, notes: e.target.value})} placeholder="Sonstiges..."></textarea>
                            </div>

                            <button type="submit" className="w-full bg-slate-900 text-white font-bold py-4 rounded-xl shadow-lg flex justify-center items-center gap-2 mx-4">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline></svg>
                                Speichern
                            </button>
                        </form>
                    </div>
                );
            };

            // LIST VIEW
            const ListView = () => {
                const [search, setSearch] = useState('');
                const filtered = exams
                    .filter(e => (e.firstName + ' ' + e.lastName + ' ' + e.expert).toLowerCase().includes(search.toLowerCase()))
                    .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());

                return (
                    <div className="px-4 pt-6 space-y">
                        <h2 className="text-2xl font-bold text-slate-900 px-2">Historie</h2>
                        <div className="relative px-4">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" style={{position: 'absolute', left: '2rem', top: '0.875rem', color: '#94a3b8'}}><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>
                            <input type="text" placeholder="Suche..." value={search} onChange={e => setSearch(e.target.value)} style={{paddingLeft: '2.75rem'}} />
                        </div>
                        
                        <div className="px-4 space-y">
                            {filtered.length === 0 ? (
                                <div className="text-center text-slate-400 py-10">Keine Eintr√§ge gefunden.</div>
                            ) : (
                                filtered.map(exam => (
                                    <div key={exam.id} className="card relative">
                                        <div className="flex justify-between items-start mb-2">
                                            <div>
                                                <h3 className="font-bold text-slate-800 text-lg">{exam.firstName} {exam.lastName}</h3>
                                                <p className="text-xs text-slate-500 flex items-center gap-1 mt-1">üë§ {exam.expert}</p>
                                            </div>
                                            <span className={`px-2 py-1 rounded text-xs font-black ${exam.passed ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}`}>{exam.passed ? 'BESTANDEN' : 'FAIL'}</span>
                                        </div>
                                        <div className="text-xs text-slate-400 mb-3 bg-slate-50 inline-block px-2 py-1 rounded">{new Date(exam.date).toLocaleDateString('de-CH')}</div>
                                        {(exam.notes || exam.error) && (
                                            <div className="bg-slate-50 p-3 rounded-xl text-sm text-slate-600 space-y mb-2">
                                                {!exam.passed && exam.error && <p className="text-red-600">‚ö†Ô∏è {exam.error}</p>}
                                                {exam.notes && <p>üìù {exam.notes}</p>}
                                            </div>
                                        )}
                                        <button onClick={() => {
                                            if (confirm('Wirklich l√∂schen?')) {
                                                setExams(exams.filter(e => e.id !== exam.id));
                                            }
                                        }} className="text-slate-300 hover:text-red-500 absolute bottom-4 right-4">
                                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
                                        </button>
                                    </div>
                                ))
                            )}
                        </div>
                    </div>
                );
            };

            // SETTINGS
            const SettingsView = () => {
                const exportData = () => {
                    const dataStr = JSON.stringify(exams, null, 2);
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(new Blob([dataStr], { type: 'application/json' }));
                    link.download = `Drivemaster_${new Date().toISOString().split('T')[0]}.json`;
                    link.click();
                };

                const importData = (e) => {
                    const file = e.target.files?.[0];
                    if (!file) return;
                    const reader = new FileReader();
                    reader.onload = (ev) => {
                        try {
                            const parsed = JSON.parse(ev.target.result);
                            if (Array.isArray(parsed)) {
                                if (confirm(`${parsed.length} Eintr√§ge importieren?`)) {
                                    setExams(parsed);
                                    alert('‚úÖ Import erfolgreich!');
                                }
                            }
                        } catch (err) {
                            alert('‚ùå Fehler beim Lesen der Datei');
                        }
                    };
                    reader.readAsText(file);
                };

                return (
                    <div className="px-4 pt-6 space-y">
                        <h2 className="text-2xl font-bold text-slate-900 px-2">Einstellungen</h2>

                        <div className="px-4 card bg-blue-900 text-white space-y">
                            <h3 className="font-bold text-lg flex items-center gap-2">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="7" y="4" width="10" height="9"></rect><rect x="2" y="14" width="20" height="5" rx="1"></rect></svg>
                                ‚úÖ App installierbar!
                            </h3>
                            <p className="text-blue-100 text-sm">Chrome: Men√º (3 Punkte) ‚Üí "App installieren"</p>
                        </div>

                        <div className="px-4 space-y">
                            <h3 className="font-bold text-slate-800 ml-2">Datensicherung</h3>
                            <button onClick={exportData} className="w-full bg-blue-50 border border-blue-200 text-blue-800 font-bold py-4 rounded-xl flex items-center justify-center gap-2">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                                Backup herunterladen
                            </button>
                            <label className="w-full bg-white border border-slate-200 text-slate-600 font-bold py-4 rounded-xl flex items-center justify-center gap-2 cursor-pointer">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
                                Backup laden
                                <input type="file" accept=".json" onChange={importData} />
                            </label>
                        </div>

                        <div className="text-center text-slate-400 text-xs py-6 px-4">
                            <div>DrivemasterStat v4.1</div>
                            <div className="text-xs mt-2">‚úÖ Vollst√§ndig offline - Keine Backend n√∂tig!</div>
                        </div>
                    </div>
                );
            };

            // RENDER
            return (
                <div className="min-h-screen bg-slate-50">
                    <div>
                        {activeTab === 'dashboard' && <DashboardView />}
                        {activeTab === 'add' && <AddExamView />}
                        {activeTab === 'list' && <ListView />}
                        {activeTab === 'settings' && <SettingsView />}
                    </div>

                    <div className="bottom-nav">
                        <button onClick={() => setActiveTab('dashboard')} className={`nav-btn ${activeTab === 'dashboard' ? 'active' : ''}`}>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="2" x2="12" y2="22"></line><path d="M17 5H9.5a1.5 1.5 0 0 0 0 3h5a1.5 1.5 0 0 1 0 3h-5a1.5 1.5 0 0 0 0 3h7.5"></path></svg>
                            <span className="text-xs font-bold mt-1">Stats</span>
                        </button>
                        <button onClick={() => setActiveTab('list')} className={`nav-btn ${activeTab === 'list' ? 'active' : ''}`}>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
                            <span className="text-xs font-bold mt-1">Liste</span>
                        </button>
                        
                        <button onClick={() => setActiveTab('add')} className="nav-btn add-btn">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                        </button>
                        
                        <button onClick={() => setActiveTab('settings')} className={`nav-btn ${activeTab === 'settings' ? 'active' : ''}`}>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="3"></circle><path d="M12 1v6m0 6v6M4.22 4.22l4.24 4.24m3.08 3.08l4.24 4.24M1 12h6m6 0h6m-13.78 7.78l4.24-4.24m3.08-3.08l4.24-4.24"></path></svg>
                            <span className="text-xs font-bold mt-1">Optionen</span>
                        </button>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<DrivemasterStat />);
    </script>
</body>
</html>